import time
import board
import busio
import adafruit_ads1x15.ads1115 as ADS
from adafruit_ads1x15.analog_in import AnalogIn


R1 = 204
R2 = 98
VOLTAGE_DIVIDER_RATIO = (R1 + R2) / R2
# VOLTAGE_DIVIDER_RATIO = 1

i2c = busio.I2C(3,2)

# Create the ADS object and specify the gain
ads = ADS.ADS1115(address=0x48, i2c=i2c)
#ads = Adafruit_ADS1x15.ADS1015(address=0x49, bus=1)
ads.gain = 2/3
chan = AnalogIn(ads, ADS.P0)

# Continuously print the values
while True:
    try:
        voltage = chan.voltage*VOLTAGE_DIVIDER_RATIO
        print(f"A0 Voltage: {voltage:0.2f}V")
    except Exception as e:
        print(f"Failed to read", e)
        time.sleep(10)
    time.sleep(1)
    
    
#     pi@dragon:~/venv $ i2cdetect -y 1
#      0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
# 00:                         -- -- -- -- -- -- -- -- 
# 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
# 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
# 30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
# 40: -- -- -- -- -- -- -- -- 48 -- -- -- -- -- -- -- 
# 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
# 60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
# 70: -- -- -- -- -- -- -- --                         


# pi@dragon:~ $ i2cdump -y 1 0x48
# No size specified (using byte-data access)
#      0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f    0123456789abcdef
# 00: 53 c3 80 7f 00 00 00 00 00 00 00 00 00 00 00 00    S???............
# 10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# 90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
# f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00    ................
